# Galgame 自动阅读器

一个在 Windows 上运行的简单工具：监听剪贴板中新的游戏文本，根据字数估算阅读时间，在等待区间结束后自动对当前鼠标位置执行一次点击（左 / 右键可选），帮助“无脑快进 / 解放回车键 / 避免手动狂点”。

> 推荐搭配 [MisakaHookFinder](https://github.com/Nitrblaze/MisakaHookFinder) 等文本提取(Hook)工具一起使用：
> MisakaHookFinder 抓取游戏文本 -> 复制/合并到剪贴板 -> 本工具检测到文本长度计算延迟 -> 自动点击继续剧情。

---

## ✨ 功能特性

- 剪贴板监控：检测到新文本自动排队处理，避免丢点击。
- 自适应等待：按“字数 / 字速”计算等待时间，并限制在最短 / 最长范围内。
- 热键控制：默认 F8 开始、F9 停止，可自定义。
- 直接点击模式：绕过部分游戏对普通模拟点击的屏蔽（win32 API 发送按键）。
- 日志可选保存：便于排查问题。
- 无托盘依赖：纯 Tkinter GUI，轻量。
- 管理员权限自提升：减少被前台 DirectX/全屏窗口拦截的概率。

---

## 🧩 适用场景

| 场景 | 用法示例 |
|------|----------|
| 日式文字冒险(VN)自动阅读 | 复制当前文本后等待自动点击继续 |
| 搭配 Hook 工具（如 MisakaHookFinder） | Hook 自动复制/聚合文本，免手动复制 |
| 解放回车/鼠标 | 长篇对白自动播放 |

---

## 📦 安装运行

### 1. 环境要求

- Windows 10/11
- Python 3.8+（建议 64 位）
- 需具备提权能力（首次启动会弹出 UAC）

### 2. 克隆 / 解压

```bash
# 方式一：Git
# git clone <your-repo-url>
# 方式二：直接把源码文件放在同一目录即可
```

### 3. 安装依赖

```bash
pip install -r requirements.txt
```

### 4. 启动

```bash
python main.py
```

首次启动若不是管理员，会自动申请以管理员重启。

---

## 🚀 使用步骤

1. 启动程序，界面显示“状态: 未运行”。
2. （可选）修改：字/秒、最短时间、最长时间、点击按键、是否“使用直接点击”。
3. （可选）勾选“保存日志”用于排查。
4. （可选）调整热键并“应用”。
5. 按“开始”或使用开始热键（默认 F8）。
6. 在游戏中复制文本（或让 MisakaHookFinder 自动复制）。
7. 程序显示：字数 + 预计等待秒数；等待结束执行一次点击。
8. 停止：按“停止”或停止热键（默认 F9）。

---

## ⚙️ 参数说明

| 参数 | 说明 |
|------|------|
| 阅读速度(字/秒) | 影响自动计算等待时间：等待 = 字数 / 速度，再夹在最短/最长之间 |
| 最短/最长(秒) | 约束等待时间上下限 |
| 鼠标按钮 | 选择左键或右键点击 |
| 使用直接点击 | 通过 win32 API 发送按下/抬起事件，适合某些屏蔽环境 |
| 保存日志 | 在 `galgame_reader_logs/` 生成时间戳日志文件 |

---

## 🪄 等待时间算法

```text
原始计算 = len(文本) / 字速
等待时间 = clamp(最短, 原始计算, 最长)
```

等待过程被切成 0.1s 小片段，可随时按停止热键立即终止尚未执行的点击。

---

## 🐞 常见问题

| 问题 | 解决方案 |
|------|----------|
| 没反应 / 不点击 | 确认已“开始”；检查是否有复制新文本；尝试开启“直接点击” |
| 热键无效 | 可能被其它软件占用；换成组合如 `ctrl+f8` |
| 文本很长等待太久 | 调低“最长”或提高“字/秒” |
| 日志不生成 | 需勾选“保存日志”，再开始运行 |
| 管理员弹窗烦 | 可右键快捷方式 -> 属性 -> 高级 -> 勾选“以管理员身份运行” |

---

## 📂 目录结构

```text
main.py                # 程序主入口
requirements.txt       # 运行依赖
auto.ico               # 程序图标（可替换）
galgame_reader_logs/   # 日志输出目录（勾选后生成）
```

---

祝使用愉快，搭配 MisakaHookFinder 畅读 Galgame！
